# NewAzureUser
Powershell script to create a new user for Entra AD in Azure. You may also copy Entra groups, distribution groups, and Teams to a specified reference user.

Prerequisites: PowerShell version 5.1 with the AzureAD Module.

To check your version of PowerBI, run:

```$PSVersionTable```

To install AzureAD, run:

```
  Install-Module -Name AzureAD
  Install-Module -Name MicrosoftTeams
  Install-Module -Name ExchangeOnlineManagement
  Install-Module -Name Microsoft.Graph
```

You can then create a new user in your Azure AD environment by running:

```
.\AddUser.ps1 -FirstName Fore -LastName Last -Password password -Dept Fake -City Exampletown -Phone 3333333333 -Title JobTitle -ReferenceUser olduser@domain.com -Domain domain.com
```

# SolarWinds Servicedesk Integration
You may also auto-populate fields in Solarwinds Servicedesk if the new user's desired information is present in the custom fields of an incident object. To use it, run:
```
.\AddUser.ps1 -Incident <incident_no> -Apikey <api_key>
```

Where <incident_no> is the incident number (visible in the incident's URL) and <api_key> is a key generated by a user with sufficient permissions in **Setup** > **Users and Groups** > **Users** > (find your user) > **JSON Web Token**.

You will need to open field_values.txt and reshuffle it based on the order your custom fields correspond to **Name, Job Title, City, Department, Country, Phone Number, and Email Address**. 
Some trial and error may be required to get these fields correct.

